# ``backme`` --- A backup files organizer

Quite often big files (like database dumps) are backed up on a
regular basis. Such backups become a disk space hogs and when time comes to
restoring data, it is cumbersome to find the right file for the job. This
script checks files of a certain pattern and sorts them by date into daily,
monthly, and yearly directories, progressively deleting more and more of the
aged files.

## Features

Traverses a directory with a huge number of disorganized backup files
recursively, deletes unnecessary ones, and packs the rest into a predictable
directory structure.

* Works with multiple backup directories, each of them independent from another.
* Takes files generated by backups and sorts them either by using
  ``yyyy-mm-dd`` pattern in the files name or by files' modification date. Then
  picks some files for archiving and deletes other files.
* It keeps all files from the last 2 days. 1 file per day for the last month,
  and one file per month afterwards.
* Files are recognized by a regular expression that matches their name. Each
  directory can have several regular expressions, and each of them (assuming
  they do not overlap) is handled separately.

## Installation

Download the [latest release] for your operating system, unzip or untar it,
copy ``backme`` file to ``/usr/local/bin`` or any other directory registered
with your ``$PATH``.

Create ``.backme.yml`` file in your ``$HOME`` directory, use a [config example]
to set it up.

To get better experience make sure your backup files contain the following
pattern in their name that corresponds to the date they were created:

```text
yyyy-mm-dd
```

For example ``mybackup-2018-01-02.sql.tar.gz``.

## Usage

To check version

```bash
backme -v
```

To organize backups

```bash
backme
```

After ``backme`` run the excess of backup files
will be deleted, and the rest will spread over an archive directory inside of
your backup directory. The structure of the directory is following:

```text
archive
  recent
  last-month
  2015
  2016
  2017
  2018
```

recent
: files from the last 2 days. All existing files from this period are preserved.

last-month
: files from the last 31 day, only one file per day is preserved.

``yyyy`` (``2015`` for example)
: files from a particular year. Only the latest file from each month is
preserved

If everything works correctly, make a daily cronjob file that would run
``backme`` regularly updating the archive directories.

[latest release]: https://github.com/dimus/backme/releases/latest
[config example]: https://github.com/dimus/backme/blob/master/.backme.yml.example
